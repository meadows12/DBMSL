mysql> create database assign5;
Query OK, 1 row affected (0.05 sec)

mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| assign5            |
| information_schema |
| mdatabase          |
| mysql              |
| performance_schema |
| sakila             |
| sdl                |
| sys                |
| te_31239           |
| world              |
+--------------------+
10 rows in set (0.00 sec)

mysql> use assign5;
Database changed
mysql> create table Customer( Cust_id int PRIMARY KEY,Name varchar(20),DateofPayment date,NameOfSchema varchar(20),Status varchar(10));
Query OK, 0 rows affected (0.23 sec)

mysql> desc customer;
+---------------+-------------+------+-----+---------+-------+
| Field         | Type        | Null | Key | Default | Extra |
+---------------+-------------+------+-----+---------+-------+
| Cust_id       | int         | NO   | PRI | NULL    |       |
| Name          | varchar(20) | YES  |     | NULL    |       |
| DateofPayment | date        | YES  |     | NULL    |       |
| NameOfSchema  | varchar(20) | YES  |     | NULL    |       |
| Status        | varchar(10) | YES  |     | NULL    |       |
+---------------+-------------+------+-----+---------+-------+
5 rows in set (0.01 sec)

mysql> insert into customer values(1,"Mrunal","2020-08-1","Savings","N");
Query OK, 1 row affected (0.01 sec)

mysql> insert into customer values(2,"Shyla","2020-08-29","Savings","N");
Query OK, 1 row affected (0.01 sec)

mysql> insert into customer values(3,"Ron","2020-08-25","Deposit","N");
Query OK, 1 row affected (0.01 sec)

mysql> insert into customer values(4,"Bob","2020-08-1","Deposit","N");
Query OK, 1 row affected (0.02 sec)

mysql> create table fine(Cust_id int PRIMARY KEY,Date date,Amt int);
Query OK, 0 rows affected (0.18 sec)

mysql> delimiter @@
mysql> create procedure getFine(IN id int,IN NameOfSchema varchar(20))
    -> begin
    ->
    -> declare payment int;
    -> declare mystatus varchar(10);
    -> declare mydate date;
    -> declare diff int;
    ->
    -> declare exit handler for 1062
    -> select "Error: Duplicate value" as "message";
    ->
    -> select DateofPayment into mydate from customer where Cust_id = id;
    -> select Status into mystatus from customer where Cust_id = id;
    -> select DATEDIFF(CURDATE(),mydate) into diff;
    ->
    -> IF diff>15 and diff<=30 then
    -> set payment = 5*diff;
    -> end if;
    -> IF diff>30 then
    -> set payment = 75 + (diff-30)*50;
    -> end if;
    ->
    -> insert into fine values(id,mydate,payment);
    -> update Customer set Status = "P" where Cust_id = id;
    ->
    ->
    -> end;
    -> @@
Query OK, 0 rows affected (0.02 sec)

mysql> call getFine(1,"Savings");
    -> @@
Query OK, 1 row affected (0.03 sec)

mysql> call getFine(1,"Savings");
    -> @@
+------------------------+
| message                |
+------------------------+
| Error: Duplicate value |
+------------------------+
1 row in set (0.00 sec)

Query OK, 0 rows affected (0.03 sec)

mysql> select * from fine;
    -> @@
+---------+------------+------+
| Cust_id | Date       | Amt  |
+---------+------------+------+
|       1 | 2020-08-01 |  825 |
+---------+------------+------+
1 row in set (0.00 sec)

mysql> select * from customer;
    -> @@
+---------+--------+---------------+--------------+--------+
| Cust_id | Name   | DateofPayment | NameOfSchema | Status |
+---------+--------+---------------+--------------+--------+
|       1 | Mrunal | 2020-08-01    | Savings      | P      |
|       2 | Shyla  | 2020-08-29    | Savings      | N      |
|       3 | Ron    | 2020-08-25    | Deposit      | N      |
|       4 | Bob    | 2020-08-01    | Deposit      | N      |
+---------+--------+---------------+--------------+--------+
4 rows in set (0.00 sec)